<!DOCTYPE html>
<html>
<body>

<input type="text" id="first_name" placeholder="First Name">

<input type="date" id="reservation_date">

<select id="reservation_slot">
  <option value="10">10:00</option>
  <option value="11">11:00</option>
  <option value="12">12:00</option>
</select>

<div id="bookings"></div>

<script>
const dateInput = document.getElementById("reservation_date");
const bookingsDiv = document.getElementById("bookings");

dateInput.value = new Date().toISOString().split("T")[0];

function loadBookings(date) {
  fetch(`/api/bookings?date=${date}`)
    .then(res => res.json())
    .then(data => {
      if (data.message) {
        bookingsDiv.innerText = "No Booking";
        return;
      }

      bookingsDiv.innerText = JSON.stringify(data);
      disableSlots(data);
    });
}

function disableSlots(bookings) {
  document.querySelectorAll("#reservation_slot option").forEach(opt => {
    opt.disabled = bookings.some(b => b.reservation_slot == opt.value);
  });
}

dateInput.addEventListener("change", () => {
  loadBookings(dateInput.value);
});

loadBookings(dateInput.value);
</script>

</body>
</html>